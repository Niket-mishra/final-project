<div class="scheme-container">

	<!-- Header -->
	<div class="d-flex justify-content-between align-items-center mb-4">
		<h4 class="title fw-bold mb-0">üè¶ Manage Loan Schemes</h4>
      <a class="btn btn-primary btn-sm" [routerLink]="['create']">
  			<i class="bi bi-plus-circle"></i> Add New Scheme
      </a>
	</div>

	<!-- Search + Filter -->
	<div class="filters d-flex gap-2 mb-3 flex-wrap">
		<input type="text" class="form-control form-control-sm" placeholder="üîç Search..." [(ngModel)]="searchTerm" (input)="applyFilters()" />
		<select class="form-select form-select-sm w-auto" [(ngModel)]="statusFilter" (change)="applyFilters()">
			<option value="">All</option>
			<option value="active">Active</option>
			<option value="inactive">Inactive</option>
		</select>
	</div>

	<!-- Loader -->
	@if (isLoading) {
		<div class="loading text-center py-4">
			<div class="spinner-border text-primary"></div>
			<p>Loading schemes‚Ä¶</p>
		</div>
	} @else {
		@if (filteredSchemes.length === 0) {
			<div class="empty text-center">
				<img class="empty-illustration" src="https://cdn-icons-png.flaticon.com/512/4076/4076509.png" />
				<p class="text-muted mt-3">No schemes found.</p>
			</div>
		} @else {
			<div class="row g-3">
				@for (scheme of filteredSchemes; track scheme.schemeId) {
					<div class="col-md-6">
						<div class="card scheme-card shadow-sm">
							<div class="card-body">
								<div class="scheme-header">
									<h5 class="mb-1">{{ scheme.schemeName }}</h5>
									<span class="badge" [ngClass]="scheme.isActive ? 'bg-success' : 'bg-secondary'">
										{{ scheme.isActive ? 'Active' : 'Inactive' }}
									</span>
								</div>

								<ul class="details">
									<li><i class="bi bi-percent"></i><strong> Rate:</strong> {{ scheme.interestRate }}%</li>
									<li><i class="bi bi-cash-coin"></i><strong> Range:</strong> ‚Çπ{{ scheme.minAmount }}‚Äì‚Çπ{{ scheme.maxAmount }}</li>
									<li><i class="bi bi-calendar-range"></i><strong> Tenure:</strong> {{ scheme.tenureMonths }} months</li>
								</ul>

								@if (scheme.eligibilityCriteria) {
									<p class="text-muted"><i class="bi bi-clipboard-check"></i> {{ scheme.eligibilityCriteria }}</p>
								}

								<div class="actions mt-3 d-flex gap-2">
                    <a class="btn btn-sm btn-outline-primary" [routerLink]="[scheme.schemeId, 'edit']">
                      <i class="bi bi-pencil"></i>
                    </a>
									<button class="btn btn-sm btn-outline-danger" (click)="confirmDelete(scheme.schemeId)">
										<i class="bi bi-trash"></i>
									</button>
									<button class="btn btn-sm btn-outline-secondary" (click)="confirmToggle(scheme)">
										<i class="bi" [ngClass]="scheme.isActive ? 'bi-x-circle' : 'bi-check-circle'"></i>
									</button>
								</div>
							</div>
						</div>
					</div>
				}
			</div>
		}
	}
</div>



<!-- üîπ Confirmation Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
	<div class="modal-dialog modal-sm">
		<div class="modal-content">
			<div class="modal-body text-center">
				<p class="mb-3">{{ confirmMessage }}</p>
				<div class="d-flex justify-content-center gap-2">
					<button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
					<button class="btn btn-danger btn-sm" (click)="confirmAction()">Yes</button>
				</div>
			</div>
		</div>
	</div>
</div>
