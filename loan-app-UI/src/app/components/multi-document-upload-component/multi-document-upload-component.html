<div class="container py-4">
  <h4 class="mb-3 fw-bold">ğŸ“ Upload Your Documents</h4>

  @if (!allDocumentsAdded()) {
    <div class="mb-3">
      <label>Select Document Type</label>
      <select [ngModel]="selectedType()" (ngModelChange)="selectedType.set($event)">
  @for (type of documentTypes; track type) {
    <option [value]="type" [disabled]="isTypeAdded(type)">
      {{ type }}
    </option>
  }
</select>
    </div>

    @if (selectedType() && !isTypeAdded(selectedType()!)) {
      <div class="mb-3">
        <label>Enter Document Number</label>
        <input type="text" [ngModel]="documentNumber()" (ngModelChange)="documentNumber.set($event)" class="form-control" />
      </div>

      <div class="mb-3">
        <label>Upload Document</label>
        <input type="file" (change)="onFileSelect($event)" class="form-control" />
      </div>

      <button class="btn btn-primary w-100"
              (click)="stageDocument()"
              [disabled]="!documentNumber() || !selectedFile()">
        â• Add Document
      </button>
    }
  }

  <hr class="my-4" />

  @if (stagedDocuments().length > 0) {
    <h5 class="fw-bold">ğŸ“¦ Staged Documents</h5>
    <ul class="list-group mb-3">
      @for (doc of stagedDocuments(); track doc.type) {
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span (click)="openPreview(doc)" class="text-primary" style="cursor: pointer;">
            {{ doc.type }} â€” {{ doc.number }}
          </span>
          <button class="btn btn-sm btn-outline-danger" (click)="removeDocument(doc.type)">âŒ</button>
        </li>
      }
    </ul>

    @if (allDocumentsAdded()) {
      <button class="btn btn-success w-100"
              (click)="uploadAll()"
              [class.btn-uploading]="isUploading()"
              [disabled]="isUploading()">
        {{ isUploading() ? 'Uploading...' : 'ğŸš€ Upload All Documents' }}
      </button>

      <div class="upload-progress">
        <div class="upload-progress-bar" [style.width.%]="uploadProgress()"></div>
      </div>
    }
  }

  @if (previewModalVisible() && previewModalUrl()) {
    <div class="modal-backdrop fade show"></div>
    <div class="modal d-block" tabindex="-1">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content position-relative">
          <button type="button"
                  class="btn-close position-absolute top-0 end-0 m-3"
                  (click)="closePreview()"></button>
          <img [src]="previewModalUrl()" alt="Preview" class="img-fluid rounded" />
        </div>
      </div>
    </div>
  }
</div>